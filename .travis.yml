sudo: required

language: ruby

services:
  - docker

branches:
  only:
    - develop 

before_install:
  - pwd
  - ls -sort
  - cd ..
  - mv travis_test CARTAvis
  - cd CARTAvis
  - ls -sort
  - pwd
  - echo $PWD
  - docker pull ajmasiaa/centos7-carta-server-18-10-2017
  - docker ps -a
  - docker run -ti -v $PWD:/cartabuild/CARTAvis ajmasiaa/centos7-carta-server-18-10-2017 /bin/sh -c "chmod 755 /cartabuild/CARTAvis/run.sh && /cartabuild/CARTAvis/run.sh"

script:
  - cd $HOME/build/ajm-asiaa/CARTAvis/build
  - ls -sort
  - mv carta-centos7-test.tar.gz Carta.dmg
  - git clone https://github.com/CARTAvis/gdrive_uploader.git
  - if [ -e "$HOME/build/CARTAvis/build/Carta.dmg" ]; then echo "dmg exist"; mv $HOME/build/CARTAvis/build/Carta.dmg ./gdrive_uploader/;cd gdrive_uploader;npm install;npm start;else echo "no dmg there"; fi

